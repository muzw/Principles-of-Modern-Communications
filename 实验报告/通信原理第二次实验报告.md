# 实验一 	调制解调（BPSK，QPSK，信噪比）

---

### 学号：PB20051061	姓名：牟真伟
---

## 实验目的

- 掌握数字频带传输系统调制解调的仿真过程

- 掌握数字频带传输系统误码率仿真分析方法

## 实验要求

1) 用 Matlab 产生独立等概的二进制信源。

   ① 画出 2ASK 调制解调中信号波形及其功率谱变化过程； 

   ② 画出 2FSK 调制解调中信号波形及其功率谱变化过程；（设$f_1-f_2>>\frac{1}{T_s}$）； 

   ③ 画出 2DPSK 调制解调中信号波形及其功率谱。 

三个题目任选其一，并在不同信噪比下对其进行抗噪声性能分析。

## 实验过程

这里选择2ASK的调制解调过程。

首先设定调制解调仿真系统的参数

```matlab
%------------------系统仿真参数 
fc=2;   	%载波频率（Hz） 
fb=1;		%码元频率
Ts=1/fb;   	% 码元宽度 
snr=5;  	%信噪比dB 
fs=16;		%系统采样率 
ts=1/fs; % 系统采样间隔 
N=1000;  	% 码元数 

t=0:ts:N*Ts-ts; %采样时间序列
t=t.'; 

NFFT=[];
window=[];
noverlap=[];
N_BPF = 48;     %FIR带通滤波器阶数
N_LPF = 48;     %FIR低通滤波器阶数
```

### 1.生成未调制的原始信号

生成未调制前的信号，由于是2ASK调制，码元幅度设置为0和1

```matlab
% 产生二进制信源 
B=randi([0,1],1,N); 
sym=[0; 1];  
A=sym(B+1); 
S=rectpulse(A, N_sample); 
% 画出未调制信号的波形
plot(t(1 :200),S(1 :200));
ylim([-0.1,1.1]);
title('未调制信号波形')
xlabel('Time (s)')
ylabel('Amplitude')
% 画出未调制信号的功率谱
pwelch(S,window,noverlap,NFFT,fs,'centered');  % 计算功率谱
title('未调制信号功率谱')
xlabel('Frequency (Hz)');
ylabel('Power');
```

未调制信号的波形及功率谱为：

| ![](http://img.zwmu.top/PicGo/202305211009382.png) | ![](http://img.zwmu.top/PicGo/202305211021505.png) |
| -------------------------------------------------- | -------------------------------------------------- |

未调制信号的功率谱在0Hz处附近值较大，为基带信号。

### 2.生成载波信号

接着生成载波信号，并将未调制信号与载波相乘，得到已调波

```matlab
X=S.*cos(2*pi*fc*t); 
```

已调制信号的波形和功率谱为：

| ![](http://img.zwmu.top/PicGo/202305211021028.png) | ![](http://img.zwmu.top/PicGo/202305211021954.png) |
| -------------------------------------------------- | -------------------------------------------------- |

基带信号与载波相乘后的功率谱公式为：
$$
P_{s}(f)=\frac{A^{2}}{4}\left[P_{m}\left(f-f_{c}\right)+P_{m}\left(f+f_{c}\right)\right]
$$
基带信号与频率为2Hz的载波相乘后，信号频谱中心变为载波频率，变成带通信号。

### 3.模拟信道噪声

将已调波通过信道，并用加性高斯白噪声模拟信道噪声

```matlab
X_n = awgn(X,snr);%这里设置信噪比为5dB
```

经信道噪声干扰后的已调制信号的波形和功率谱为：

| ![](http://img.zwmu.top/PicGo/202305211034553.png) | ![](http://img.zwmu.top/PicGo/202305211034856.png) |
| -------------------------------------------------- | -------------------------------------------------- |

经过信道噪声干扰后信号波形变得杂乱，由于白噪声功率谱为恒定值，因此干扰后的功率谱没有了之前的一排旁瓣的形式，而是除了在2Hz附近信号功率外，其余频率的功率约在17dB左右。

### 4.接收信号通过带通滤波器

2ASK调制信号的有效信号的频率范围为$f_c-f_b$到$f_c+f_b$中间，设计一个带通滤波器，滤除带外噪声

```matlab
 %设置理想FIR带通滤波器的截止频率为fc-fb,fc+fb,阶数为N_BPF
W = [(fc-fb)/(fs/2) (fc+fb)/(fs/2)];
b1 = fir1(N_BPF,W);
X_bpf = filter(b1,1,X_n);
```

经过带通滤波器的信号为：

| ![](http://img.zwmu.top/PicGo/202305211416386.png) | ![](http://img.zwmu.top/PicGo/202305211416750.png) |
| -------------------------------------------------- | -------------------------------------------------- |

可以看出，$f_c-f_b$到$f_c+f_b$频率区间外的噪声功率降低到-70dB左右。

### 5.相干解调

接着对接收到的信号进行相干解调，先对接收到的信号乘上载波

```matlab
r=2*X_n.*cos(2*pi*fc*t);
```

信号波形和功率谱变为：

| ![](http://img.zwmu.top/PicGo/202305211424139.png) | ![](http://img.zwmu.top/PicGo/202305211424587.png) |
| -------------------------------------------------- | -------------------------------------------------- |

信号再次乘载波后，得到基带的低频分量和4Hz的高频分量，下面通过低通滤波器滤掉高频分量

设置低通滤波器的截止频率为fb

```matlab
b2 = fir1(N_LPF,fb/(fs/2));
X_lpf = filter(b2,1,r);
```

结果为：

| ![](http://img.zwmu.top/PicGo/202305211428661.png) | ![](http://img.zwmu.top/PicGo/202305211428188.png) |
| -------------------------------------------------- | -------------------------------------------------- |

可以看出，高频分量被滤除，剩下基带信号

### 6.时延补偿，抽样判决

由于前面FIR带通和低通滤波器会引入时延，因此在抽样判决前，要对信号进行时延补偿。

FIR滤波器的群延时为阶数的一半，这里FIR带通和低通滤波器阶数均为48，因此总延时为48，将接收信号时移提前，同时最后48/fs=3个码元信息会丢失，因此将原始信号的最后三个码元去掉。

抽样判决门限为码元幅度的一半0.5。

```matlab
delay = N_BPF + N_LPF;
X_r = X_lpf(48:end);
N=N-3;
B=B(1:end-3);
index = fs/2:fs:N*fs-fs/2;
Sr=X_r(index)'; 
Br=Sr>0.5; 
```

时延补偿后的信号波形为：

| ![](http://img.zwmu.top/PicGo/202305211436078.png) | ![](http://img.zwmu.top/PicGo/202305211436583.png) |
| -------------------------------------------------- | -------------------------------------------------- |

### 7.计算误码率

将判决结果与原始信号作比较，并计算错误码元数，除以总码元数既是误码率

```matlab
errbit=sum(Br~=B); 
ber=errbit/N; % 误码率
```

在5dB噪声情况下，误码率为0.01左右

## 实验结果及分析

调制解调过程中总的信号波形及其功率谱变化过程如下：

![](http://img.zwmu.top/PicGo/202305211445321.png)

![](http://img.zwmu.top/PicGo/202305211445318.png)

下面分析一下信噪比的接收端误码率的影响：

分别计算在不同信噪比下的误码率，并画出图像如下

![](http://img.zwmu.top/PicGo/202305211501672.png)

​	可以看出，误码率随信噪比增大而减小，当信噪比达到8dB以上时，接收端误码率接近为0，当信噪比小于30dB时，接收端误码率为50%左右，此时相当于完全随机猜测码元。

## 实验总结

​	本次实验通过对2ASK调制解调过程的仿真，学习了调制解调过程的基本步骤以及各个步骤的基本原理，信号的功率谱在各个过程中是如何变化的。在实验过程中，要注意滤波器引入的时延，若不对时延进行处理，则抽样判决时，抽样信号与原始信号不对齐，计算出来的误码率会很大。
